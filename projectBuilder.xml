<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Expect definition of JavaFX ant tasks is already imported -->

<project name="pasSHA" basedir="." xmlns:fx="javafx:com.sun.javafx.tools.ant" default="all">

	<buildnumber file="dist_resources\build.version"/>

	<!-- Detect correct Operating system and set PATH variables -->
	<condition property="JDKLIB" value="${java.home}/../jdk${java.version}/lib" else="${java.home}/../lib" >
		<os family="windows" />
	</condition>
	<condition property="JRELIB" value="${java.home}/lib" else="${java.home}/lib" >
		<os family="windows" />
	</condition>
	
	<!-- Default build target -->
	<target name="all" depends="cleanall">

	<path id="fxant">
		<filelist>
			<file name="${JDKLIB}/ant-javafx.jar" />
			<file name="${JRELIB}/ext/jfxrt.jar" />
		</filelist>
	</path>
		
		<!-- Build routine -->
		<taskdef resource="com/sun/javafx/tools/ant/antlib.xml" uri="javafx:com.sun.javafx.tools.ant" classpathref="fxant" />
		
		<!-- Copy all resources like .gif, licence etc. -->
		<copy todir="./bin/resources">
			<fileset dir="./resources" />
		</copy>

		<fx:jar destfile="dist/pasSHA.jar">

			<!-- Details about application -->
			<fx:application name="pasSHA" mainClass="main.Main" />

			<!-- Define what auxilary resources are needed -->
			<fx:resources>
				<fx:fileset dir="dist" includes="resources/*.jar" />
			</fx:resources>

			<!-- What to include into result jar file? Everything in the build tree -->
			<fileset dir="bin" />

			<!-- Customize jar manifest (optional) -->
			<manifest>
				<attribute name="Implementation-Vendor" value="KGBT" />
				<attribute name="Implementation-Version" value="2.3.000" />
			</manifest>
		</fx:jar>

		<!-- Release -->
		<copy file="dist_resources/README.txt" tofile="dist/README.txt" />
		<copy file="dist_resources/GNUGPLv3.txt" tofile="dist/GNUGPLv3.txt" />
		<copy file="dist_resources/updater.bat" tofile="dist/updater.bat" />
	</target>
	
	<target name="cleanall">
		<delete dir="dist" />
		<mkdir dir="dist" />
		<mkdir dir="dist/logs" />
		<mkdir dir="dist/user" />
	</target>

</project>
